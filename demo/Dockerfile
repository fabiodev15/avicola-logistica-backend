# Stage 1: Build
FROM eclipse-temurin:25-jdk-alpine AS build

WORKDIR /app

# Copiar archivos de Gradle
COPY gradlew .
COPY gradle gradle
COPY build.gradle .
COPY settings.gradle .

# Dar permisos de ejecuci贸n a gradlew
RUN chmod +x gradlew

# Copiar c贸digo fuente
COPY src src

# Compilar la aplicaci贸n (sin ejecutar tests para acelerar el build)
RUN ./gradlew build -x test --no-daemon

# Stage 2: Run
FROM eclipse-temurin:25-jre-alpine

WORKDIR /app

# Copiar el JAR compilado desde el stage anterior
COPY --from=build /app/build/libs/*.jar app.jar

# Exponer el puerto 8080
EXPOSE 8080

# Ejecutar la aplicaci贸n
ENTRYPOINT ["java", "-jar", "app.jar"]
